import requests
import json

def upload_excel_to_sharepoint(file_path, site_id, drive_id, folder_path):
    # Get access token using Microsoft Graph API
    token_url = 'https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token'
    client_id = 'your_client_id'
    client_secret = 'your_client_secret'
    tenant_id = 'your_tenant_id'
    scope = 'https://graph.microsoft.com/.default'

    token_payload = {
        'grant_type': 'client_credentials',
        'client_id': client_id,
        'client_secret': client_secret,
        'scope': scope
    }

    token_response = requests.post(token_url.format(tenant_id=tenant_id), data=token_payload)
    access_token = json.loads(token_response.text)['access_token']

    # Upload file to SharePoint using Microsoft Graph API
    upload_url = 'https://graph.microsoft.com/v1.0/sites/{site_id}/drives/{drive_id}/root:/{folder_path}/{file_name}:/content'
    file_name = file_path.split('/')[-1]

    headers = {
        'Authorization': 'Bearer ' + access_token,
        'Content-Type': 'application/octet-stream',
        'Content-Length': str(os.path.getsize(file_path))
    }

    with open(file_path, 'rb') as f:
        file_content = f.read()

    upload_response = requests.put(upload_url.format(site_id=site_id, drive_id=drive_id, folder_path=folder_path, file_name=file_name), headers=headers, data=file_content)

    if upload_response.status_code == 201:
        print('File uploaded successfully')
    else:
        print('Error uploading file:', upload_response.text)
